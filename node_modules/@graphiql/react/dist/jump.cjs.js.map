{"version":3,"file":"jump.cjs.js","sources":["../../codemirror-graphql/esm/utils/jump-addon.js","../../codemirror-graphql/esm/jump.js"],"sourcesContent":["import CodeMirror from 'codemirror';\nCodeMirror.defineOption('jump', false, (cm, options, old) => {\n    if (old && old !== CodeMirror.Init) {\n        const oldOnMouseOver = cm.state.jump.onMouseOver;\n        CodeMirror.off(cm.getWrapperElement(), 'mouseover', oldOnMouseOver);\n        const oldOnMouseOut = cm.state.jump.onMouseOut;\n        CodeMirror.off(cm.getWrapperElement(), 'mouseout', oldOnMouseOut);\n        CodeMirror.off(document, 'keydown', cm.state.jump.onKeyDown);\n        delete cm.state.jump;\n    }\n    if (options) {\n        const state = (cm.state.jump = {\n            options,\n            onMouseOver: onMouseOver.bind(null, cm),\n            onMouseOut: onMouseOut.bind(null, cm),\n            onKeyDown: onKeyDown.bind(null, cm),\n        });\n        CodeMirror.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n        CodeMirror.on(cm.getWrapperElement(), 'mouseout', state.onMouseOut);\n        CodeMirror.on(document, 'keydown', state.onKeyDown);\n    }\n});\nfunction onMouseOver(cm, event) {\n    const target = event.target || event.srcElement;\n    if (!(target instanceof HTMLElement)) {\n        return;\n    }\n    if ((target === null || target === void 0 ? void 0 : target.nodeName) !== 'SPAN') {\n        return;\n    }\n    const box = target.getBoundingClientRect();\n    const cursor = {\n        left: (box.left + box.right) / 2,\n        top: (box.top + box.bottom) / 2,\n    };\n    cm.state.jump.cursor = cursor;\n    if (cm.state.jump.isHoldingModifier) {\n        enableJumpMode(cm);\n    }\n}\nfunction onMouseOut(cm) {\n    if (!cm.state.jump.isHoldingModifier && cm.state.jump.cursor) {\n        cm.state.jump.cursor = null;\n        return;\n    }\n    if (cm.state.jump.isHoldingModifier && cm.state.jump.marker) {\n        disableJumpMode(cm);\n    }\n}\nfunction onKeyDown(cm, event) {\n    if (cm.state.jump.isHoldingModifier || !isJumpModifier(event.key)) {\n        return;\n    }\n    cm.state.jump.isHoldingModifier = true;\n    if (cm.state.jump.cursor) {\n        enableJumpMode(cm);\n    }\n    const onKeyUp = (upEvent) => {\n        if (upEvent.code !== event.code) {\n            return;\n        }\n        cm.state.jump.isHoldingModifier = false;\n        if (cm.state.jump.marker) {\n            disableJumpMode(cm);\n        }\n        CodeMirror.off(document, 'keyup', onKeyUp);\n        CodeMirror.off(document, 'click', onClick);\n        cm.off('mousedown', onMouseDown);\n    };\n    const onClick = (clickEvent) => {\n        const { destination, options } = cm.state.jump;\n        if (destination) {\n            options.onClick(destination, clickEvent);\n        }\n    };\n    const onMouseDown = (_, downEvent) => {\n        if (cm.state.jump.destination) {\n            downEvent.codemirrorIgnore = true;\n        }\n    };\n    CodeMirror.on(document, 'keyup', onKeyUp);\n    CodeMirror.on(document, 'click', onClick);\n    cm.on('mousedown', onMouseDown);\n}\nconst isMac = typeof navigator !== 'undefined' &&\n    navigator &&\n    navigator.appVersion.includes('Mac');\nfunction isJumpModifier(key) {\n    return key === (isMac ? 'Meta' : 'Control');\n}\nfunction enableJumpMode(cm) {\n    if (cm.state.jump.marker) {\n        return;\n    }\n    const { cursor, options } = cm.state.jump;\n    const pos = cm.coordsChar(cursor);\n    const token = cm.getTokenAt(pos, true);\n    const getDestination = options.getDestination || cm.getHelper(pos, 'jump');\n    if (getDestination) {\n        const destination = getDestination(token, options, cm);\n        if (destination) {\n            const marker = cm.markText({ line: pos.line, ch: token.start }, { line: pos.line, ch: token.end }, { className: 'CodeMirror-jump-token' });\n            cm.state.jump.marker = marker;\n            cm.state.jump.destination = destination;\n        }\n    }\n}\nfunction disableJumpMode(cm) {\n    const { marker } = cm.state.jump;\n    cm.state.jump.marker = null;\n    cm.state.jump.destination = null;\n    marker.clear();\n}\n//# sourceMappingURL=jump-addon.js.map","import CodeMirror from 'codemirror';\nimport getTypeInfo from './utils/getTypeInfo';\nimport { getArgumentReference, getDirectiveReference, getEnumValueReference, getFieldReference, getTypeReference, } from './utils/SchemaReference';\nimport './utils/jump-addon';\nCodeMirror.registerHelper('jump', 'graphql', (token, options) => {\n    if (!options.schema || !options.onClick || !token.state) {\n        return;\n    }\n    const { state } = token;\n    const { kind, step } = state;\n    const typeInfo = getTypeInfo(options.schema, state);\n    if ((kind === 'Field' && step === 0 && typeInfo.fieldDef) ||\n        (kind === 'AliasedField' && step === 2 && typeInfo.fieldDef)) {\n        return getFieldReference(typeInfo);\n    }\n    if (kind === 'Directive' && step === 1 && typeInfo.directiveDef) {\n        return getDirectiveReference(typeInfo);\n    }\n    if (kind === 'Argument' && step === 0 && typeInfo.argDef) {\n        return getArgumentReference(typeInfo);\n    }\n    if (kind === 'EnumValue' && typeInfo.enumValue) {\n        return getEnumValueReference(typeInfo);\n    }\n    if (kind === 'NamedType' && typeInfo.type) {\n        return getTypeReference(typeInfo);\n    }\n});\n//# sourceMappingURL=jump.js.map"],"names":["CodeMirror","getTypeInfo","getFieldReference","getDirectiveReference","getArgumentReference","getEnumValueReference","getTypeReference"],"mappings":"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"}