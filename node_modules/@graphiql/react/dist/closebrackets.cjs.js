"use strict";var N=Object.defineProperty;var f=(S,A)=>N(S,"name",{value:A,configurable:!0});var G=require("./codemirror.cjs.js");function H(S,A){return A.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(d){if(d!=="default"&&!(d in S)){var o=Object.getOwnPropertyDescriptor(n,d);Object.defineProperty(S,d,o.get?o:{enumerable:!0,get:function(){return n[d]}})}})}),Object.freeze(Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}))}f(H,"_mergeNamespaces");var F={exports:{}};(function(S,A){(function(n){n(G.codemirror$1.exports)})(function(n){var d={pairs:`()[]{}''""`,closeBefore:`)]}'":;>`,triples:"",explode:"[]{}"},o=n.Pos;n.defineOption("autoCloseBrackets",!1,function(e,t,a){a&&a!=n.Init&&(e.removeKeyMap(B),e.state.closeBrackets=null),t&&(_(P(t,"pairs")),e.state.closeBrackets=t,e.addKeyMap(B))});function P(e,t){return t=="pairs"&&typeof e=="string"?e:typeof e=="object"&&e[t]!=null?e[t]:d[t]}f(P,"getOption");var B={Backspace:L,Enter:W};function _(e){for(var t=0;t<e.length;t++){var a=e.charAt(t),i="'"+a+"'";B[i]||(B[i]=K(a))}}f(_,"ensureBound"),_(d.pairs+"`");function K(e){return function(t){return z(t,e)}}f(K,"handler");function x(e){var t=e.state.closeBrackets;if(!t||t.override)return t;var a=e.getModeAt(e.getCursor());return a.closeBrackets||t}f(x,"getConfig");function L(e){var t=x(e);if(!t||e.getOption("disableInput"))return n.Pass;for(var a=P(t,"pairs"),i=e.listSelections(),r=0;r<i.length;r++){if(!i[r].empty())return n.Pass;var h=w(e,i[r].head);if(!h||a.indexOf(h)%2!=0)return n.Pass}for(var r=i.length-1;r>=0;r--){var l=i[r].head;e.replaceRange("",o(l.line,l.ch-1),o(l.line,l.ch+1),"+delete")}}f(L,"handleBackspace");function W(e){var t=x(e),a=t&&P(t,"explode");if(!a||e.getOption("disableInput"))return n.Pass;for(var i=e.listSelections(),r=0;r<i.length;r++){if(!i[r].empty())return n.Pass;var h=w(e,i[r].head);if(!h||a.indexOf(h)%2!=0)return n.Pass}e.operation(function(){var l=e.lineSeparator()||`
`;e.replaceSelection(l+l,null),O(e,-1),i=e.listSelections();for(var v=0;v<i.length;v++){var k=i[v].head.line;e.indentLine(k,null,!0),e.indentLine(k+1,null,!0)}})}f(W,"handleEnter");function O(e,t){for(var a=[],i=e.listSelections(),r=0,h=0;h<i.length;h++){var l=i[h];l.head==e.getCursor()&&(r=h);var v=l.head.ch||t>0?{line:l.head.line,ch:l.head.ch+t}:{line:l.head.line-1};a.push({anchor:v,head:v})}e.setSelections(a,r)}f(O,"moveSel");function q(e){var t=n.cmpPos(e.anchor,e.head)>0;return{anchor:new o(e.anchor.line,e.anchor.ch+(t?-1:1)),head:new o(e.head.line,e.head.ch+(t?1:-1))}}f(q,"contractSelection");function z(e,t){var a=x(e);if(!a||e.getOption("disableInput"))return n.Pass;var i=P(a,"pairs"),r=i.indexOf(t);if(r==-1)return n.Pass;for(var h=P(a,"closeBefore"),l=P(a,"triples"),v=i.charAt(r+1)==t,k=e.listSelections(),j=r%2==0,c,R=0;R<k.length;R++){var I=k[R],s=I.head,u,y=e.getRange(s,o(s.line,s.ch+1));if(j&&!I.empty())u="surround";else if((v||!j)&&y==t)v&&D(e,s)?u="both":l.indexOf(t)>=0&&e.getRange(s,o(s.line,s.ch+3))==t+t+t?u="skipThree":u="skip";else if(v&&s.ch>1&&l.indexOf(t)>=0&&e.getRange(o(s.line,s.ch-2),s)==t+t){if(s.ch>2&&/\bstring/.test(e.getTokenTypeAt(o(s.line,s.ch-2))))return n.Pass;u="addFour"}else if(v){var $=s.ch==0?" ":e.getRange(o(s.line,s.ch-1),s);if(!n.isWordChar(y)&&$!=t&&!n.isWordChar($))u="both";else return n.Pass}else if(j&&(y.length===0||/\s/.test(y)||h.indexOf(y)>-1))u="both";else return n.Pass;if(!c)c=u;else if(c!=u)return n.Pass}var b=r%2?i.charAt(r-1):t,E=r%2?t:i.charAt(r+1);e.operation(function(){if(c=="skip")O(e,1);else if(c=="skipThree")O(e,3);else if(c=="surround"){for(var g=e.getSelections(),p=0;p<g.length;p++)g[p]=b+g[p]+E;e.replaceSelections(g,"around"),g=e.listSelections().slice();for(var p=0;p<g.length;p++)g[p]=q(g[p]);e.setSelections(g)}else c=="both"?(e.replaceSelection(b+E,null),e.triggerElectric(b+E),O(e,-1)):c=="addFour"&&(e.replaceSelection(b+b+b+b,"before"),O(e,1))})}f(z,"handleChar");function w(e,t){var a=e.getRange(o(t.line,t.ch-1),o(t.line,t.ch+1));return a.length==2?a:null}f(w,"charsAround");function D(e,t){var a=e.getTokenAt(o(t.line,t.ch+1));return/\bstring/.test(a.type)&&a.start==t.ch&&(t.ch==0||!/\bstring/.test(e.getTokenTypeAt(t)))}f(D,"stringStartsAfter")})})();var J=F.exports,Q=H({__proto__:null,default:J},[F.exports]);exports.closebrackets=Q;
//# sourceMappingURL=closebrackets.cjs.js.map
