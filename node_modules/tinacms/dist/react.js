(function(global, factory) {
  typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("react")) : typeof define === "function" && define.amd ? define(["exports", "react"], factory) : (global = typeof globalThis !== "undefined" ? globalThis : global || self, factory(global.tinacms = {}, global.NOOP));
})(this, function(exports2, React) {
  "use strict";
  function _interopDefaultLegacy(e) {
    return e && typeof e === "object" && "default" in e ? e : { "default": e };
  }
  var React__default = /* @__PURE__ */ _interopDefaultLegacy(React);
  function useTina(props) {
    const [data, setData] = React__default["default"].useState(props.data);
    const id = JSON.stringify({ query: props.query, variables: props.variables });
    React__default["default"].useEffect(() => {
      setData(props.data);
    }, [id]);
    React__default["default"].useEffect(() => {
      parent.postMessage({ type: "open", ...props, id }, window.location.origin);
      window.addEventListener("message", (event) => {
        if (event.data.id === id && event.data.type === "updateData") {
          setData(event.data.data);
        }
      });
      return () => parent.postMessage({ type: "close", id }, window.location.origin);
    }, [id]);
    return { data };
  }
  function useEditState() {
    const [edit, setEdit] = React__default["default"].useState(false);
    React__default["default"].useEffect(() => {
      if (typeof window !== "undefined") {
        parent.postMessage({ type: "isEditMode" }, window.location.origin);
        window.addEventListener("message", (event) => {
          var _a;
          if (((_a = event.data) == null ? void 0 : _a.type) === "tina:editMode") {
            setEdit(true);
          }
        });
      }
    }, []);
    return { edit };
  }
  const tinaField = (obj, field) => {
    var _a, _b, _c;
    if (!field) {
      return `${(_a = obj.__meta__) == null ? void 0 : _a.id}#${(_b = obj.__meta__) == null ? void 0 : _b.name}`;
    }
    if (obj == null ? void 0 : obj.__meta__) {
      if (typeof field === "string") {
        return `${(_c = obj.__meta__) == null ? void 0 : _c.id}#${obj.__meta__.fields[field]}`;
      }
    }
    return "";
  };
  exports2.tinaField = tinaField;
  exports2.useEditState = useEditState;
  exports2.useTina = useTina;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
